### Tcp协议的缺陷
1. 传输效率较低：TCP协议为了保证数据的可靠性，采用了复杂的确认机制和重传机制，这些机制会增加数据在网络中的传输次数，从而导致传输效率较低，特别是在高延迟、高丢包率的网络环境下，传输效率更加低下。
2. 拥塞控制不够灵活：TCP协议的拥塞控制机制是基于全局的网络拥塞情况进行调整的，不能针对单个连接进行优化。这种机制会导致某个连接因为网络拥塞而被限制带宽，从而影响其传输速度，而其他连接则不受影响。
3. 容易受到攻击：TCP协议的传输过程中，数据包的来源和目的地都可以伪造，这给中间人攻击、IP欺骗等攻击方式提供了可能。同时，由于TCP协议没有加密的机制，所以数据包内容也容易被窃听和篡改。
4. 不适合实时应用：由于TCP协议需要多次确认和重传数据，因此对于实时性要求较高的应用，如实时视频、游戏等，TCP协议的延迟和不确定性可能导致不良的用户体验。
5. 总之，TCP协议虽然是一种可靠的传输协议，但是它的传输效率较低、拥塞控制不够灵活、容易受到攻击、不适合实时应用等缺陷，限制了其在某些场景下的应用。为了解决这些问题，人们正在研究和开发一些新的传输协议，如QUIC协议等。

### TCP
1. 面向链接，传输效率低，复杂的确认机制和重传机制，这些机制会增加数据在网络中传输的次数
2. 阻塞控制，降低速率，减轻网络负载和拥塞速度
3. 流量控制，通过滑动窗口来实现，动态的控制发送的效率。
4. 全双工通信：TCP 连接是全双工的，即客户端和服务器可以同时进行数据的发送和接收。在关闭连接之前，双方需要确保彼此的数据都已经发送完毕，以免造成数据丢失或不完整。

数据传输确认：通过四次挥手过程，双方可以相互确认对方已经接收到所有数据。在关闭连接之前，双方会交换确认报文段，以确保所有数据都已经被正确传输。

确定关闭顺序：四次挥手过程中，先发起关闭连接的一方会等待对方的确认报文段，以确保双方按照正确的顺序进行连接关闭。这样可以避免数据的混乱和错误的连接状态。

处理延迟数据：在关闭连接后，仍然可能有一些延迟的数据在网络中传输，这些数据可能是之前发送的但未及时到达的。通过四次挥手过程中的 TIME_WAIT 状态，可以确保双方在关闭连接后的一段时间内能够处理到达的延迟数据，避免数据混乱。

资源释放：四次挥手的最后一步是双方都确认关闭连接，并释放相关的资源。这样可以有效地回收和释放网络连接所占用的资源，避免资源泄露和浪费。


### Tcp连接原理
1. TCP（传输控制协议）是一种面向连接的、可靠的传输协议，它在网络层（第三层）和应用层（第四层）之间提供了可靠的数据传输服务。下面是 TCP 数据传输的原理解释：
2. 连接建立：在进行数据传输之前，发送方（客户端）和接收方（服务器）需要先建立一个 TCP 连接。连接建立过程中，双方交换一系列的控制报文段（SYN 和 ACK），确立连接并进行参数协商。
3. 数据分割：发送方将要传输的数据分割成合适的大小（根据 MSS 最大报文段长度）的数据块，每个数据块称为一个 TCP 报文段。这样可以适应不同网络环境的传输需求。
4. 可靠传输：发送方将每个 TCP 报文段添加一个序列号（Sequence Number）后发送给接收方。接收方收到报文段后，会发送确认报文段（ACK）给发送方，表示已经正确接收到报文段。如果发送方没有收到确认报文段，会进行超时重传，确保数据的可靠传输。
5. 流量控制：TCP 通过使用滑动窗口（Sliding Window）来进行流量控制，确保发送方和接收方之间的数据传输速率匹配。接收方通过确认报文段中的窗口大小告诉发送方自己的接收能力，发送方根据窗口大小来控制发送数据的速度。
6. 拥塞控制：TCP 通过拥塞窗口（Congestion Window）来进行拥塞控制，避免网络拥塞和传输过程中的数据丢失。发送方根据网络的拥塞状况和接收方的反馈调整拥塞窗口大小，以控制发送的数据量。
7. 接收方缓存：接收方使用接收缓存来暂存接收到的数据，确保数据的顺序性和完整性。接收方会根据序列号将接收到的数据按正确的顺序进行组装。
8. 连接关闭：数据传输完成后，发送方和接收方需要进行连接的关闭。通过四次挥手的过程，双方交换确认报文段，最终关闭连接并释放相关资源。



