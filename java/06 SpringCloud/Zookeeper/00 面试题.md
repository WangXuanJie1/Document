## 工作中使用过 Zookeeper 嘛？你知道它✁什么， 有什么用途呢？
1. 第一种：集群管理 在多个节点组成的集群中，为了保证集群的HA特性，每个节点都会冗余一份数据副本。这种情况下需要保证客户端访问集群中的任意一个节点都是最新的数据。
2. 如何保证跨进程的共享资源的并发安全性，对于分布式系统来说也是一个比较大的挑战，而为了达到 这样一个目的，必须要使用跨进程的锁也就是分布式锁来实现。
3. 在多个节点组成的集群中，为了降低集群数据同步的复杂度，一般会存在Master和Slave两种角色的 节点，Master负责事务和非事务请求处理，Slave负责非事务请求处理。但是在分布式系统中如何确定某个节点是Master还是Slave，也成了一个难度不小的挑战。

## 命名服务
1. Zookeeper 可以创✁ 一个全局唯一✁路径，这个路径就可以作为一个名字。被命名✁实体可以✁集 群中✁机器，服务✁地址，或者✁远程✁对象等。一些分布式服务框架 （RPC、RMI）中✁服务地址列表，通过使用命名服务，客户端应用能够根据
特定✁名字来获取资源✁实体、服务地址和提供者信息等

## 配置管理
1. 实际项目开发中，我们经常使用.properties 或者 xml 需要配置很多信息，如 数据库连➓信息、fps 地址端口等等。因为你✁程序一般✁分布式部署在不同 ✁机器上（如果你✁单机应用当我没说），如果把程序✁这些配置信息保存在
zk ✁ znode 节点下，当你要修改配置，即 znode 会发生变化时，可以通过改变 zk 中某个目录节点✁内容，利用 watcher 通知给各个客户端，从而更改 配置

``` java
import org.apache.zookeeper.*;
import java.io.IOException;
import java.nio.charset.StandardCharsets;

public class ConfigManager implements Watcher {

    private final static String ZK_CONNECT_STRING = "localhost:2181";
    private final static int SESSION_TIMEOUT = 5000;

    private ZooKeeper zkClient;
    private String configPath;

    public ConfigManager(String configPath) {
        this.configPath = configPath;
        try {
            zkClient = new ZooKeeper(ZK_CONNECT_STRING, SESSION_TIMEOUT, this);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void updateConfig(String key, String value) throws KeeperException, InterruptedException {
        String path = configPath + "/" + key;
        byte[] data = value.getBytes(StandardCharsets.UTF_8);
        if (zkClient.exists(path, false) != null) {
            zkClient.setData(path, data, -1);
        } else {
            zkClient.create(path, data, ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);
        }
    }

    public String getConfig(String key) throws KeeperException, InterruptedException {
        String path = configPath + "/" + key;
        byte[] data = zkClient.getData(path, false, null);
        return new String(data, StandardCharsets.UTF_8);
    }

    @Override
    public void process(WatchedEvent event) {
        if (event.getType() == Event.EventType.None && event.getState() == Event.KeeperState.SyncConnected) {
            System.out.println("ZooKeeper Client connected");
        } else if (event.getType() == Event.EventType.NodeDataChanged && event.getPath().equals(configPath)) {
            System.out.println("Configuration updated, reloading...");
            // TODO: reload configuration
        }
    }
}

```

## 集群管理
1. 集群管理包括集群监控和集群控制，其实就✁监控集群机器状态，剔除机器和 加入机器。zookeeper 可以方便集群机器✁管理，它可以实时监控 znode 节点 ✁变化，一旦发现有机器挂了，该机器就会与 zk断开连➓，对用✁临时目录节 点会被删除，其他所有机器都收到通知。新机器加入也✁类似酱紫，所有机
器收到通知：有新兄弟目录加入啦

## 你提到了 znode 节点，那你知道 znode 有几 种类型呢？zookeeper ✁数据模型✁怎样✁呢？
1. 持久节点（PERSISTENT） 这类节点被创✁后，就会一直存在于 Zk 服务器上。直到手动删除
2. 持久顺序节点（PERSISTENT_SEQUENTIAL）  它✁基本特性同持久节点，不同在于增加了顺序性。父节点会维护一个自增整 性数字，用于子节点✁创✁✁先后顺序
3. 临时节点，它✁基本特性同持久节点，不同在于增加了顺序性。父节点会维护一个自增整 性数字，用于子节点✁创✁✁先后顺序
4. 临时顺序节点（EPHEMERAL_SEQUENTIAL）

## 你知道 znode 节点里面存储✁✁什么吗？每个 节点✁数据最大不能超过多少呢
1. Znode 包含了存储数据、访问权限、子节点引用、节点状态信息
2. data: znode 存储✁业务数据信息 
3. ACL: 记录客户端对 znode 节点✁访问权限，如 IP 等。 
4. child: 当前节点✁子节点引用
5. stat: 包含 Znode 节点✁状态信息，比如事务 id、版本号、时间戳等等

## 你知道 znode 节点上✁监听机制嘛？讲 下Zookeeper watch机制吧

